# 神石系统 功能设计文档示例

> 本文档为系统玩法类型的参考示例，展示独立系统玩法的文档编写方式。

---

## 一、设计目的

### 1.1 功能定位

神石系统是游戏的资源养成玩法之一，为玩家提供属性加成和资源获取途径。该系统的核心价值在于：
- 提供长期养成目标（收集不同类型神石）
- 增加玩家属性成长路径
- 丰富游戏探索体验

### 1.2 期望体验

- **探索乐趣**：玩家在场景中发现神石，获得惊喜感
- **收集成就**：不同类型神石激发收集欲望
- **属性提升**：神石带来可见的属性加成，增强角色实力
- **策略选择**：玩家根据自身需求选择优先收集的神石类型

---

## 二、功能概述

### 2.1 背景概述

远古时期，强大的魔法能量凝结成神秘的神石，散落在王国各处。这些神石蕴含不同属性的力量，玩家可以搜集神石并吸收其能量，获得永久的属性加成。

### 2.2 功能简介

**核心玩法**：

玩家在大地图探索时，会随机刷新神石点。玩家靠近神石可以拾取，拾取后神石加入玩家的神石背包。每种类型的神石提供特定的属性加成（如攻击、防御、生命等）。玩家可以在神石界面查看已拥有的神石和属性加成效果。

**主要特点**：

1. **随机刷新**：神石在地图上随机刷新，增加探索乐趣
2. **类型多样**：多种神石类型，对应不同属性加成
3. **即时生效**：拾取神石后属性立即生效
4. **可视化收藏**：神石界面展示所有已获得神石
5. **稀有度区分**：神石分为普通、稀有、史诗、传说等级别

**玩家操作**：

1. 在大地图上探索，发现神石图标
2. 靠近神石点击拾取
3. 获得神石和属性加成
4. 在神石界面查看收藏和加成

### 2.3 结构划分

```
神石系统
├── 神石刷新模块
│   ├── 随机刷新逻辑
│   ├── 刷新位置管理
│   └── 神石类型权重
├── 神石拾取模块
│   ├── 拾取判定
│   ├── 背包添加
│   └── 属性结算
├── 神石界面模块
│   ├── 神石图鉴
│   ├── 属性加成显示
│   └── 收集进度
└── 属性加成模块
    ├── 基础属性加成
    ├── 特殊效果加成
    └── 套装效果（可选）
```

---

## 三、规则说明

### 3.1 神石类型与属性

| 神石类型 | 稀有度 | 属性加成 | 特殊效果 |
|----------|--------|----------|----------|
| 力量神石 | 普通 | 攻击力+50 | 无 |
| 守护神石 | 普通 | 防御力+50 | 无 |
| 生命神石 | 普通 | 生命值+500 | 无 |
| 狂暴神石 | 稀有 | 攻击力+120，暴击率+5% | 无 |
| 铁壁神石 | 稀有 | 防御力+120，格挡率+5% | 无 |
| 迅捷神石 | 稀有 | 攻速+10%，移速+5% | 无 |
| 烈焰神石 | 史诗 | 攻击力+200，火焰伤害+15% | 攻击附带燃烧效果 |
| 寒冰神石 | 史诗 | 攻击力+200，冰冻几率+10% | 攻击有几率冰冻敌人 |
| 雷霆神石 | 传说 | 攻击力+500，暴击伤害+30% | 暴击触发连锁闪电 |
| 创世神石 | 传说 | 全属性+10% | 技能冷却-20% |

### 3.2 神石刷新规则

#### 3.2.1 刷新时间

| 刷新类型 | 刷新规则 |
|----------|----------|
| 固定刷新 | 每天00:00、12:00固定刷新50个神石点 |
| 动态刷新 | 被拾取的神石30分钟后在其他位置重新刷新 |
| 特殊刷新 | 每周日18:00额外刷新10个稀有以上神石 | **刷新位置**：
- 地图划分为100个刷新区域
- 每个区域最多同时存在2个神石
- 刷新时随机选择未满的区域
- 玩家当前所在区域不会刷新（避免突然出现）

**刷新数量上限**：
- 地图上最多同时存在100个神石
- 达到上限后，停止刷新直到有神石被拾取

### 3.3 神石稀有度权重

| 稀有度 | 刷新权重 | 刷新概率 |
|--------|----------|----------|
| 普通 | 60 | 60% |
| 稀有 | 30 | 30% |
| 史诗 | 8 | 8% |
| 传说 | 2 | 2% |

**特殊规则**：
- 玩家VIP等级≥5时，史诗权重+2%，传说权重+1%
- 每周日特殊刷新时，稀有以上神石权重各+10%

### 3.4 神石拾取规则

**拾取条件**：
- 玩家与神石距离≤5米
- 玩家神石背包未满（上限1000个）
- 神石未被其他玩家拾取（单人模式不存在此情况）

**拾取流程**：
1. 玩家靠近神石，出现"拾取"按钮
2. 点击按钮，播放拾取动画（约1秒）
3. 神石添加到玩家背包
4. 属性立即生效
5. 地图上神石消失

**拾取奖励**：
- 基础奖励：获得神石及其属性加成
- 首次拾取：该类型神石首次拾取额外获得100金币
- 连续拾取：30秒内拾取3个以上神石，额外获得50经验

### 3.5 属性加成计算

**基础加成**：
- 神石属性直接叠加到玩家属性面板
- 多个相同神石的加成可累加

**公式**：
```
最终攻击力 = 基础攻击力 + Σ(神石攻击力加成) × (1 + 百分比加成)
```

**示例**：
- 玩家基础攻击力：1000
- 拥有3个力量神石（每个+50攻击）
- 拥有1个狂暴神石（+120攻击，+5%暴击）
- 最终攻击力 = 1000 + (50×3 + 120) = 1270

### 3.6 特殊处理

| 特殊情况 | 处理方式 |
|----------|----------|
| 神石背包已满 | 无法拾取，提示"神石背包已满，请清理后再拾取" |
| 拾取时网络断线 | 拾取未生效，神石保留在地图上 |
| 同时有多人拾取同一神石 | 先到先得，后到者提示"该神石已被拾取" |
| 玩家等级不足 | 可以拾取，但属性加成降低50%（建议等级≥10） |
| 地图切换时有未拾取神石 | 神石保留在原地图，不跟随玩家 |
| 拾取传说级神石 | 全服公告："玩家XXX获得传说神石YYY" |

### 3.7 神石管理

**背包管理**：
- 神石背包独立于普通背包
- 容量上限：1000个
- 支持按类型、稀有度筛选
- 支持一键整理（相同神石合并显示）

**神石分解**（可选功能）：
- 玩家可以分解多余的神石
- 分解获得"神石碎片"货币
- 碎片可在商店兑换稀有神石

---

## 四、策划需求

### 4.1 数值需求

**神石数量配置**：

| 配置项 | 数值 |
|--------|------|
| 地图神石总数上限 | 100个 |
| 玩家背包容量 | 1000个 |
| 固定刷新数量 | 50个/次（00:00和12:00） |
| 动态刷新时间 | 30分钟 |
| 周日特殊刷新 | 10个稀有以上神石 |

**属性加成数值**：

参见3.1神石类型与属性表格

**稀有度权重**：

参见3.3神石稀有度权重表格

### 4.2 系统需求

**依赖系统**：
- **地图系统**：提供神石刷新位置，处理玩家与神石的距离判定
- **属性系统**：接收神石属性加成，重新计算玩家属性
- **背包系统**：提供独立的神石背包空间
- **公告系统**：传说神石拾取时发送全服公告
- **任务系统**：拾取神石可作为任务目标
- **成就系统**：收集神石可触发成就

**接口需求**：
- `GetNearbyGodStones(playerId, radius)`：获取玩家附近的神石列表
- `PickupGodStone(playerId, stoneId)`：拾取神石
- `GetPlayerGodStones(playerId)`：获取玩家拥有的神石列表
- `CalculateGodStoneBonus(playerId)`：计算神石属性加成
- `RefreshGodStones()`：执行神石刷新逻辑

### 4.3 配置表需求

**新建表：godstone_config**

| 字段名 | 类型 | 说明 |
|--------|------|------|
| stone_id | int | 神石ID |
| stone_name | string | 神石名称 |
| stone_type | enum | 神石类型 |
| rarity | enum | 稀有度：common/rare/epic/legendary |
| attr_attack | int | 攻击力加成 |
| attr_defense | int | 防御力加成 |
| attr_hp | int | 生命值加成 |
| attr_crit_rate | float | 暴击率加成（百分比） |
| special_effect | json | 特殊效果配置 |
| icon_path | string | 图标路径 |

**新建表：godstone_refresh_config**

| 字段名 | 类型 | 说明 |
|--------|------|------|
| refresh_id | int | 刷新配置ID |
| refresh_type | enum | 刷新类型：fixed/dynamic/special |
| refresh_time | string | 刷新时间（如"00:00"） |
| refresh_count | int | 刷新数量 |
| rarity_weight | json | 稀有度权重配置 |

**新建表：player_godstone**

| 字段名 | 类型 | 说明 |
|--------|------|------|
| player_id | bigint | 玩家ID |
| stone_id | int | 神石ID |
| count | int | 拥有数量 |
| first_get_time | datetime | 首次获得时间 |

**新建表：map_godstone_instance**

| 字段名 | 类型 | 说明 |
|--------|------|------|
| instance_id | bigint | 实例ID，主键 |
| stone_id | int | 神石配置ID |
| map_id | int | 地图ID |
| position_x | float | 刷新位置X |
| position_y | float | 刷新位置Y |
| spawn_time | datetime | 刷新时间 |
| status | enum | 状态：active/picked |
| picked_by | bigint | 拾取玩家ID（如已被拾取） |

---

## 附录：参考信息

**文档版本**：v1.0  
**创建时间**：2026-01-28  
**最后更新**：2026-01-28  

**说明**：
- 本文档为系统玩法类型的示例，重点展示了独立系统的规则设计和数值配置
- 系统玩法类文档需要特别关注刷新规则、数值平衡和玩家收集体验
- 可根据实际项目需求添加更多玩法深度（如神石强化、神石套装等）
